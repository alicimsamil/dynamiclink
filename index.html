<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mobile OS Redirect</title>
  </head>
  <body>
    <script>
      const getMobileOS = () => {
        const ua = navigator.userAgent;
        if (/android/i.test(ua)) {
          return "Android";
        } else if (/iPad|iPhone|iPod/.test(ua)) {
          return "iOS";
        }
        return "Other";
      };

      const redirectToApp = (androidPackageName, iOSAppId, redirectUrl) => {
        const os = getMobileOS();
        if (os === "Android") {
          window.onload = checkApp;
        } else if (os === "iOS") {
          window.location.href = `https://apps.apple.com/de/app/${iOSAppId}`;
        } else {
          window.location.href = redirectUrl;
        }
      };

      const urlParams = new URLSearchParams(window.location.search);
      const androidPackageName = "com.amvg.hemlak";
      const iOSAppId = 496855282;
      const redirectUrl = urlParams.get("redirectUrl");

      if (androidPackageName && iOSAppId && redirectUrl) {
        redirectToApp(androidPackageName, iOSAppId, redirectUrl);
      }

      function checkApp() {
        var startTime = new Date().getTime();
        var appScheme = "https://hepsiemlak.com";

        window.location.href = appScheme;

        setTimeout(function () {
          var endTime = new Date().getTime();
          var timeoutMilliseconds = 2000; 

          if (endTime - startTime < timeoutMilliseconds && document.hidden) {
          } else {
            var marketUrl = `market://details?id=${androidPackageName}`;
            window.location.href = marketUrl;
          }
        }, 1000);
      }
    </script>
  </body>
</html>
